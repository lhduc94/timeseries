<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chương 3 Smoothing | Phân tích Chuỗi thời gian</title>
  <meta name="description" content="Time Serie Analysis" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chương 3 Smoothing | Phân tích Chuỗi thời gian" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Time Serie Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chương 3 Smoothing | Phân tích Chuỗi thời gian" />
  
  <meta name="twitter:description" content="Time Serie Analysis" />
  

<meta name="author" content="Lê Huỳnh Đức" />


<meta name="date" content="2023-12-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="arima.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/highlight.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Lời nói đầu</a></li>
<li class="chapter" data-level="1" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html"><i class="fa fa-check"></i><b>1</b> Giới thiệu Cơ bản về Time Series</a>
<ul>
<li class="chapter" data-level="1.1" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#time-series-là-gì"><i class="fa fa-check"></i><b>1.1</b> Time Series là gì</a></li>
<li class="chapter" data-level="1.2" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#các-patterns-time-series"><i class="fa fa-check"></i><b>1.2</b> Các patterns Time Series</a></li>
<li class="chapter" data-level="1.3" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#stationary-tính-dừng-của-dữ-liệu"><i class="fa fa-check"></i><b>1.3</b> Stationary (Tính dừng của dữ liệu)</a></li>
<li class="chapter" data-level="1.4" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#các-bài-toán-về-chuỗi-thời-gian"><i class="fa fa-check"></i><b>1.4</b> Các bài toán về chuỗi thời gian</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#dự-đoán-giá-trị-tiếp-theo-dựa-trên-các-giá-trị-trước-đó"><i class="fa fa-check"></i><b>1.4.1</b> Dự đoán giá trị tiếp theo dựa trên các giá trị trước đó</a></li>
<li class="chapter" data-level="1.4.2" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#phân-loại-chuỗi-thời-gian"><i class="fa fa-check"></i><b>1.4.2</b> Phân loại chuỗi thời gian</a></li>
<li class="chapter" data-level="1.4.3" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#phân-đoạn-chuỗi-thời-gian"><i class="fa fa-check"></i><b>1.4.3</b> Phân đoạn chuỗi thời gian</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="arima.html"><a href="arima.html"><i class="fa fa-check"></i><b>2</b> ARIMA</a>
<ul>
<li class="chapter" data-level="2.1" data-path="arima.html"><a href="arima.html#lag"><i class="fa fa-check"></i><b>2.1</b> Lag</a></li>
<li class="chapter" data-level="2.2" data-path="arima.html"><a href="arima.html#autocorrelation-tự-tương-quan"><i class="fa fa-check"></i><b>2.2</b> Autocorrelation (Tự tương quan)</a></li>
<li class="chapter" data-level="2.3" data-path="arima.html"><a href="arima.html#partial-autocorrelation"><i class="fa fa-check"></i><b>2.3</b> Partial Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="smoothing.html"><a href="smoothing.html"><i class="fa fa-check"></i><b>3</b> Smoothing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="smoothing.html"><a href="smoothing.html#moving-average-smoothing"><i class="fa fa-check"></i><b>3.1</b> Moving Average Smoothing</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="smoothing.html"><a href="smoothing.html#centered-moving-average"><i class="fa fa-check"></i><b>3.1.1</b> Centered Moving Average</a></li>
<li class="chapter" data-level="3.1.2" data-path="smoothing.html"><a href="smoothing.html#trailing-moving-average"><i class="fa fa-check"></i><b>3.1.2</b> Trailing Moving Average</a></li>
<li class="chapter" data-level="3.1.3" data-path="smoothing.html"><a href="smoothing.html#ví-dụ"><i class="fa fa-check"></i><b>3.1.3</b> Ví dụ</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="" target="blank">Lê Huỳnh Đức</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Phân tích Chuỗi thời gian</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="smoothing" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chương 3</span> Smoothing<a href="smoothing.html#smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Kỹ thuật làm mịn là một trong các kỹ thuật tiền xử lý dữ liệu để loại bỏ các nhiễu trong dữ liệu. Việc làm mịn dữ liệu giúp thể hiện rõ tính mùa vụ của dữ liệu và giúp đơn giản hóa các mô hình dự đoán.</p>
<p>Các kỹ thuật làm mịn dữ liệu bao gồm:</p>
<ul>
<li>Làm mịn trung bình trượt (Moving Average Smoothing)</li>
<li>Làm mịn cấp số nhân (Exponential smoothing)</li>
</ul>
<div id="moving-average-smoothing" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Moving Average Smoothing<a href="smoothing.html#moving-average-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Có 2 loại trung bình trượt : Centered MA và Trailing MA</p>
<div id="centered-moving-average" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Centered Moving Average<a href="smoothing.html#centered-moving-average" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Với trung bình trượt với cửa sổ trượt <span class="math inline">\(k\)</span> bằng 3 ta có:</p>
<p><span class="math display">\[\begin{align}
\Large \bar{y}_{T} = \frac{y_{T+1} + y_{T} + y_{T-1}}{3}
\end{align}\]</span></p>
<p>Tổng quát hơn</p>
<p><span class="math inline">\(\begin{align} \Large \bar{y}_{T} = \frac{1}{m} \sum_{j=-m}^{m}{y_{T+j}} \end{align}\)</span></p>
<p>Trong đó <span class="math inline">\(k = 2m + 1\)</span></p>
<p>Phương pháp này sử dụng giá trị tương lai <span class="math inline">\(y_{T+1}\)</span> do đó không áp dụng được vào các mô hình dự báo. Phương pháp dùng để thống kê mô tả dữ liệu, là một phương pháp để loại bỏ xu hướng và tính mùa vụ của Time Series</p>
</div>
<div id="trailing-moving-average" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Trailing Moving Average<a href="smoothing.html#trailing-moving-average" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Với trung bình trượt với cửa sổ trượt <span class="math inline">\(k\)</span> bằng 3 ta có</p>
<p><span class="math inline">\(\begin{align} \Large \bar{y}_{T} = \frac{y_{T} + y_{T - 1} + y_{T - 2}}{3} \end{align}\)</span></p>
<p>Tổng quát hơn</p>
<p><span class="math inline">\(\begin{align} \Large \bar{y}_{T} = \frac{1}{k} \sum^{k}_{i=1}{y_{T-i+1}} \end{align}\)</span></p>
<p>Phương pháp này chỉ sử dụng dữ liệu quá khứ nên có thể áp dụng cho việc dự báo các giá trị tương lai</p>
</div>
<div id="ví-dụ" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Ví dụ<a href="smoothing.html#ví-dụ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dưới đây là ví dụ về số Sales quần áo của US</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="smoothing.html#cb10-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;../data/us-retail-sales.csv&#39;</span>)</span>
<span id="cb10-2"><a href="smoothing.html#cb10-2" tabindex="-1"></a>df[<span class="st">&#39;lag_1&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Clothing&#39;</span>].shift(<span class="dv">1</span>)</span>
<span id="cb10-3"><a href="smoothing.html#cb10-3" tabindex="-1"></a>df[<span class="st">&#39;lag_2&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Clothing&#39;</span>].shift(<span class="dv">2</span>)</span>
<span id="cb10-4"><a href="smoothing.html#cb10-4" tabindex="-1"></a>df[<span class="st">&#39;lead_1&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Clothing&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb10-5"><a href="smoothing.html#cb10-5" tabindex="-1"></a>df[<span class="st">&#39;Centered_MA&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;Clothing&#39;</span>] <span class="op">+</span> df[<span class="st">&#39;lead_1&#39;</span>] <span class="op">+</span> df[<span class="st">&#39;lag_1&#39;</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb10-6"><a href="smoothing.html#cb10-6" tabindex="-1"></a>df[<span class="st">&#39;Trailing_MA&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;Clothing&#39;</span>] <span class="op">+</span> df[<span class="st">&#39;lag_1&#39;</span>] <span class="op">+</span> df[<span class="st">&#39;lag_2&#39;</span>])<span class="op">/</span><span class="dv">3</span></span></code></pre></div>
<pre><code>         Month   Clothing     lag_1     lag_2    lead_1   Centered_MA    Trailing_MA
275 2014-12-01      32760       NaN       NaN   15840.0           NaN            NaN
276 2015-01-01      15840   32760.0       NaN   18079.0  22226.333333            NaN
277 2015-02-01      18079   15840.0   32760.0   20819.0  18246.000000   22226.333333
278 2015-03-01      20819   18079.0   15840.0   20470.0  19789.333333   18246.000000
279 2015-04-01      20470   20819.0   18079.0   22239.0  21176.000000   19789.333333
...        ...        ...       ...       ...       ...           ...            ...
331 2019-08-01      23829   21742.0   21116.0   19567.0  21712.666667   22229.000000
332 2019-09-01      19567   23829.0   21742.0   21400.0  21598.666667   21712.666667
333 2019-10-01      21400   19567.0   23829.0   25170.0  22045.666667   21598.666667
334 2019-11-01      25170   21400.0   19567.0   35157.0  27242.333333   22045.666667
335 2019-12-01      35157   25170.0   21400.0       NaN           NaN   27242.333333</code></pre>
<p>Ta cũng có thể sử dụng phương thức <code>rolling()</code> trong Pandas</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="smoothing.html#cb12-1" tabindex="-1"></a>df[<span class="st">&#39;Centered_MA&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Clothing&#39;</span>].rolling(window<span class="op">=</span><span class="dv">3</span>, center<span class="op">=</span><span class="va">True</span>).mean()</span>
<span id="cb12-2"><a href="smoothing.html#cb12-2" tabindex="-1"></a>df[<span class="st">&#39;Trailing_MA&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Clothing&#39;</span>].rolling(window<span class="op">=</span><span class="dv">3</span>, center<span class="op">=</span><span class="va">False</span>).mean()</span></code></pre></div>
<p>Để visualize dữ liệu, ta có thể dùng <code>seaborn</code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="smoothing.html#cb13-1" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb13-2"><a href="smoothing.html#cb13-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb13-3"><a href="smoothing.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="smoothing.html#cb13-4" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb13-5"><a href="smoothing.html#cb13-5" tabindex="-1"></a>plt.title(<span class="st">&quot;US Retail Sale - Clothing&quot;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb13-6"><a href="smoothing.html#cb13-6" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Month&#39;</span>, y<span class="op">=</span><span class="st">&#39;Clothing&#39;</span>, data<span class="op">=</span>df, label<span class="op">=</span><span class="st">&#39;original&#39;</span>)</span>
<span id="cb13-7"><a href="smoothing.html#cb13-7" tabindex="-1"></a><span class="co"># sns.lineplot(x=&#39;Month&#39;, y=&#39;Centered_MA&#39;, data=df, label=&#39;Centered_MA&#39;)</span></span>
<span id="cb13-8"><a href="smoothing.html#cb13-8" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Month&#39;</span>, y<span class="op">=</span><span class="st">&#39;Centered_MA&#39;</span>, data<span class="op">=</span>df, label<span class="op">=</span><span class="st">&#39;Trailing_MA&#39;</span>)</span>
<span id="cb13-9"><a href="smoothing.html#cb13-9" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Month&#39;</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb13-10"><a href="smoothing.html#cb13-10" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb13-11"><a href="smoothing.html#cb13-11" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Clothing&#39;</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb13-12"><a href="smoothing.html#cb13-12" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">15</span>)</span></code></pre></div>
<p><img src="../images/03/MA.png" /></p>
<p>Với dữ liệu bao gồm xu hướng và mùa vụ, việc gia tăng cửa sổ trượt giúp loại bỏ tính mùa vụ và chỉ để lại tính xu hướng. Ví dụ dưới đây cho dữ liệu <code>Số Vật liệu xây dựng đã sử dụng ở Mỹ</code>
với các tham số <span class="math inline">\(k =6\)</span> và <span class="math inline">\(k=12\)</span></p>
<table>
<colgroup>
<col width="46%" />
<col width="53%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(k=6\)</span></th>
<th align="center"><span class="math inline">\(k=12\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><img src="../images/03/6-MA.png" title="abc" alt="‘abc’" /></td>
<td align="center"><img src="../images/03/12-MA.png" title="abcd" alt="‘abcd’" /></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arima.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "Merriweather",
"size": 4
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"toc_depth": 2,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
