<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chương 2 Smoothing | Phân tích Chuỗi thời gian</title>
  <meta name="description" content="Time Serie Analysis" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chương 2 Smoothing | Phân tích Chuỗi thời gian" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Time Serie Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chương 2 Smoothing | Phân tích Chuỗi thời gian" />
  
  <meta name="twitter:description" content="Time Serie Analysis" />
  

<meta name="author" content="Lê Huỳnh Đức" />


<meta name="date" content="2023-12-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="giới-thiệu-cơ-bản-về-time-series.html"/>
<link rel="next" href="arima.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/highlight.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Lời nói đầu</a></li>
<li class="chapter" data-level="1" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html"><i class="fa fa-check"></i><b>1</b> Giới thiệu Cơ bản về Time Series</a>
<ul>
<li class="chapter" data-level="1.1" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#time-series-là-gì"><i class="fa fa-check"></i><b>1.1</b> Time Series là gì</a></li>
<li class="chapter" data-level="1.2" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#các-patterns-time-series"><i class="fa fa-check"></i><b>1.2</b> Các patterns Time Series</a></li>
<li class="chapter" data-level="1.3" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#các-đặc-điểm-của-time-series"><i class="fa fa-check"></i><b>1.3</b> Các đặc điểm của Time Series</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#stationary-tính-dừng-của-dữ-liệu"><i class="fa fa-check"></i><b>1.3.1</b> Stationary (Tính dừng của dữ liệu)</a></li>
<li class="chapter" data-level="1.3.2" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#lag"><i class="fa fa-check"></i><b>1.3.2</b> Lag</a></li>
<li class="chapter" data-level="1.3.3" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#autocorrelation-tự-tương-quan"><i class="fa fa-check"></i><b>1.3.3</b> Autocorrelation (Tự tương quan)</a></li>
<li class="chapter" data-level="1.3.4" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#partial-autocorrelation"><i class="fa fa-check"></i><b>1.3.4</b> Partial Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#các-bài-toán-về-chuỗi-thời-gian"><i class="fa fa-check"></i><b>1.4</b> Các bài toán về chuỗi thời gian</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#dự-đoán-giá-trị-tiếp-theo-dựa-trên-các-giá-trị-trước-đó"><i class="fa fa-check"></i><b>1.4.1</b> Dự đoán giá trị tiếp theo dựa trên các giá trị trước đó</a></li>
<li class="chapter" data-level="1.4.2" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#phân-loại-chuỗi-thời-gian"><i class="fa fa-check"></i><b>1.4.2</b> Phân loại chuỗi thời gian</a></li>
<li class="chapter" data-level="1.4.3" data-path="giới-thiệu-cơ-bản-về-time-series.html"><a href="giới-thiệu-cơ-bản-về-time-series.html#phân-đoạn-chuỗi-thời-gian"><i class="fa fa-check"></i><b>1.4.3</b> Phân đoạn chuỗi thời gian</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="smoothing.html"><a href="smoothing.html"><i class="fa fa-check"></i><b>2</b> Smoothing</a>
<ul>
<li class="chapter" data-level="2.1" data-path="smoothing.html"><a href="smoothing.html#moving-average-smoothing"><i class="fa fa-check"></i><b>2.1</b> Moving Average Smoothing</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="smoothing.html"><a href="smoothing.html#centered-moving-average"><i class="fa fa-check"></i><b>2.1.1</b> Centered Moving Average</a></li>
<li class="chapter" data-level="2.1.2" data-path="smoothing.html"><a href="smoothing.html#trailing-moving-average"><i class="fa fa-check"></i><b>2.1.2</b> Trailing Moving Average</a></li>
<li class="chapter" data-level="2.1.3" data-path="smoothing.html"><a href="smoothing.html#ví-dụ"><i class="fa fa-check"></i><b>2.1.3</b> Ví dụ</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="smoothing.html"><a href="smoothing.html#exponential-smoothing"><i class="fa fa-check"></i><b>2.2</b> Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="smoothing.html"><a href="smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>2.2.1</b> Simple Exponential Smoothing</a></li>
<li class="chapter" data-level="2.2.2" data-path="smoothing.html"><a href="smoothing.html#double-exponential-smoothing-holts-method"><i class="fa fa-check"></i><b>2.2.2</b> Double Exponential Smoothing (Holt’s Method)</a></li>
<li class="chapter" data-level="2.2.3" data-path="smoothing.html"><a href="smoothing.html#triple-exponential-smoothing-holt-winters-method"><i class="fa fa-check"></i><b>2.2.3</b> Triple Exponential Smoothing (Holt-Winters’ Method)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="arima.html"><a href="arima.html"><i class="fa fa-check"></i><b>3</b> ARIMA</a>
<ul>
<li class="chapter" data-level="3.1" data-path="arima.html"><a href="arima.html#autoregressive-model"><i class="fa fa-check"></i><b>3.1</b> Autoregressive Model</a></li>
<li class="chapter" data-level="3.2" data-path="arima.html"><a href="arima.html#moving-average-model"><i class="fa fa-check"></i><b>3.2</b> Moving Average Model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="" target="blank">Lê Huỳnh Đức</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Phân tích Chuỗi thời gian</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="smoothing" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chương 2</span> Smoothing<a href="smoothing.html#smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Kỹ thuật làm mịn là một trong các kỹ thuật tiền xử lý dữ liệu để loại bỏ các nhiễu trong dữ liệu. Việc làm mịn dữ liệu giúp xóa bỏ mùa vụ của dữ liệu và giúp đơn giản hóa các mô hình dự đoán.</p>
<p>Các kỹ thuật làm mịn dữ liệu bao gồm:</p>
<ul>
<li>Làm mịn trung bình trượt (Moving Average Smoothing)</li>
<li>Làm mịn cấp số nhân (Exponential smoothing)</li>
</ul>
<div id="moving-average-smoothing" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Moving Average Smoothing<a href="smoothing.html#moving-average-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Có 2 loại trung bình trượt : Centered MA và Trailing MA</p>
<div id="centered-moving-average" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Centered Moving Average<a href="smoothing.html#centered-moving-average" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Với trung bình trượt với cửa sổ trượt <span class="math inline">\(k\)</span> bằng 3 ta có:</p>
<p><span class="math display">\[\begin{align}
\Large s_{t} = \frac{y_{t+1} + y_{t} + y_{t-1}}{3}
\end{align}\]</span></p>
<p>Tổng quát hơn</p>
<p><span class="math display">\[\begin{align}
\Large s_{t} = \frac{1}{m}  \sum_{j=-m}^{m}{y_{t+j}}
\end{align}\]</span></p>
<p>Trong đó <span class="math inline">\(k = 2m + 1\)</span></p>
<p>Phương pháp này sử dụng giá trị tương lai <span class="math inline">\(y_{t+1}\)</span> do đó không áp dụng được vào các mô hình dự báo. Phương pháp dùng để thống kê mô tả dữ liệu</p>
</div>
<div id="trailing-moving-average" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Trailing Moving Average<a href="smoothing.html#trailing-moving-average" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Với trung bình trượt với cửa sổ trượt <span class="math inline">\(k\)</span> bằng 3 ta có</p>
<p><span class="math display">\[\begin{align}
\Large s_{t} = \frac{y_{t} + y_{t - 1} + y_{t - 2}}{3}
\end{align}\]</span></p>
<p>Tổng quát hơn</p>
<p><span class="math display">\[\begin{align}
\Large s_{t} = \frac{1}{k} \sum^{k}_{i=1}{y_{t-i+1}}
\end{align}\]</span></p>
<p>Phương pháp này chỉ sử dụng dữ liệu quá khứ nên có thể áp dụng cho việc dự báo các giá trị tương lai</p>
</div>
<div id="ví-dụ" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Ví dụ<a href="smoothing.html#ví-dụ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dưới đây là ví dụ về số bé gái sinh ra mỗi ngày</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="smoothing.html#cb10-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;../data/daily-total-female-births.csv&#39;</span>)</span>
<span id="cb10-2"><a href="smoothing.html#cb10-2" tabindex="-1"></a>df[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;Date&#39;</span>])</span>
<span id="cb10-3"><a href="smoothing.html#cb10-3" tabindex="-1"></a>df[<span class="st">&#39;lag_1&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Births&#39;</span>].shift(<span class="dv">1</span>)</span>
<span id="cb10-4"><a href="smoothing.html#cb10-4" tabindex="-1"></a>df[<span class="st">&#39;lag_2&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Births&#39;</span>].shift(<span class="dv">2</span>)</span>
<span id="cb10-5"><a href="smoothing.html#cb10-5" tabindex="-1"></a>df[<span class="st">&#39;lead_1&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Births&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb10-6"><a href="smoothing.html#cb10-6" tabindex="-1"></a>df[<span class="st">&#39;Centered_MA&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;Births&#39;</span>] <span class="op">+</span> df[<span class="st">&#39;lead_1&#39;</span>] <span class="op">+</span> df[<span class="st">&#39;lag_1&#39;</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb10-7"><a href="smoothing.html#cb10-7" tabindex="-1"></a>df[<span class="st">&#39;Trailing_MA&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;Births&#39;</span>] <span class="op">+</span> df[<span class="st">&#39;lag_1&#39;</span>] <span class="op">+</span> df[<span class="st">&#39;lag_2&#39;</span>])<span class="op">/</span><span class="dv">3</span></span></code></pre></div>
<pre><code>          Date Births   lag_1   lag_2   lead_1  Centered_MA Trailing_MA Births_MA
0   1959-01-01     35     NaN     NaN     32.0          NaN         NaN       NaN
1   1959-01-02     32    35.0     NaN     30.0    32.333333         NaN       NaN
2   1959-01-03     30    32.0    35.0     31.0    31.000000   32.333333       NaN
3   1959-01-04     31    30.0    32.0     44.0    35.000000   31.000000       NaN
4   1959-01-05     44    31.0    30.0     29.0    34.666667   35.000000       NaN
...        ...    ...     ...     ...      ...          ...         ...       ...
360 1959-12-27     37    34.0    44.0     52.0    41.000000   38.333333 41.666667
361 1959-12-28     52    37.0    34.0     48.0    45.666667   41.000000 41.666667
362 1959-12-29     48    52.0    37.0     55.0    51.666667   45.666667 42.416667
363 1959-12-30     55    48.0    52.0     50.0    51.000000   51.666667 43.666667
364 1959-12-31     50    55.0    48.0      NaN          NaN   51.000000 44.333333</code></pre>
<p>Ta cũng có thể sử dụng phương thức <code>rolling()</code> trong Pandas</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="smoothing.html#cb12-1" tabindex="-1"></a>df[<span class="st">&#39;Centered_MA&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Births&#39;</span>].rolling(window<span class="op">=</span><span class="dv">3</span>, center<span class="op">=</span><span class="va">True</span>).mean()</span>
<span id="cb12-2"><a href="smoothing.html#cb12-2" tabindex="-1"></a>df[<span class="st">&#39;Trailing_MA&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Births&#39;</span>].rolling(window<span class="op">=</span><span class="dv">3</span>, center<span class="op">=</span><span class="va">False</span>).mean()</span></code></pre></div>
<p>Để visualize dữ liệu, ta có thể dùng <code>seaborn</code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="smoothing.html#cb13-1" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb13-2"><a href="smoothing.html#cb13-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb13-3"><a href="smoothing.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="smoothing.html#cb13-4" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb13-5"><a href="smoothing.html#cb13-5" tabindex="-1"></a>plt.title(<span class="st">&quot;Births&quot;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb13-6"><a href="smoothing.html#cb13-6" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;Births&#39;</span>, data<span class="op">=</span>df, label<span class="op">=</span><span class="st">&#39;original&#39;</span>)</span>
<span id="cb13-7"><a href="smoothing.html#cb13-7" tabindex="-1"></a><span class="co"># sns.lineplot(x=&#39;Month&#39;, y=&#39;Centered_MA&#39;, data=df, label=&#39;Centered_MA&#39;)</span></span>
<span id="cb13-8"><a href="smoothing.html#cb13-8" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;Births&#39;</span>, data<span class="op">=</span>df, label<span class="op">=</span><span class="st">&#39;Trailing_MA&#39;</span>)</span>
<span id="cb13-9"><a href="smoothing.html#cb13-9" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date&#39;</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb13-10"><a href="smoothing.html#cb13-10" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb13-11"><a href="smoothing.html#cb13-11" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Births&#39;</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb13-12"><a href="smoothing.html#cb13-12" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">15</span>)</span></code></pre></div>
<p><img src="../images/02/MA.png" /></p>
<p>với các tham số <span class="math inline">\(k =6\)</span> và <span class="math inline">\(k=12\)</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="smoothing.html#cb14-1" tabindex="-1"></a>fig1 <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb14-2"><a href="smoothing.html#cb14-2" tabindex="-1"></a>df[<span class="st">&#39;Births_MA&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Births&#39;</span>].rolling(window<span class="op">=</span><span class="dv">6</span>, center<span class="op">=</span><span class="va">False</span>).mean()</span>
<span id="cb14-3"><a href="smoothing.html#cb14-3" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;Births&#39;</span>, data<span class="op">=</span>df, label<span class="op">=</span><span class="st">&#39;original&#39;</span>)</span>
<span id="cb14-4"><a href="smoothing.html#cb14-4" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;Births_MA&#39;</span>, data<span class="op">=</span>df, label<span class="op">=</span><span class="st">&#39;6-MA&#39;</span>)</span>
<span id="cb14-5"><a href="smoothing.html#cb14-5" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Month&#39;</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb14-6"><a href="smoothing.html#cb14-6" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb14-7"><a href="smoothing.html#cb14-7" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb14-8"><a href="smoothing.html#cb14-8" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Birds&#39;</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb14-9"><a href="smoothing.html#cb14-9" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb14-10"><a href="smoothing.html#cb14-10" tabindex="-1"></a>plt.title(<span class="st">&#39;6-MA&#39;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span></code></pre></div>
<p><img src="../images/02/6-MA.png" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="smoothing.html#cb15-1" tabindex="-1"></a>fig2 <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb15-2"><a href="smoothing.html#cb15-2" tabindex="-1"></a>df[<span class="st">&#39;Births_MA&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Births&#39;</span>].rolling(window<span class="op">=</span><span class="dv">12</span>, center<span class="op">=</span><span class="va">False</span>).mean()</span>
<span id="cb15-3"><a href="smoothing.html#cb15-3" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;Births&#39;</span>, data<span class="op">=</span>df, label<span class="op">=</span><span class="st">&#39;original&#39;</span>)</span>
<span id="cb15-4"><a href="smoothing.html#cb15-4" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;Births_MA&#39;</span>, data<span class="op">=</span>df, label<span class="op">=</span><span class="st">&#39;12-MA&#39;</span>)</span>
<span id="cb15-5"><a href="smoothing.html#cb15-5" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date&#39;</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb15-6"><a href="smoothing.html#cb15-6" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb15-7"><a href="smoothing.html#cb15-7" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb15-8"><a href="smoothing.html#cb15-8" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Date&#39;</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb15-9"><a href="smoothing.html#cb15-9" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb15-10"><a href="smoothing.html#cb15-10" tabindex="-1"></a>plt.title(<span class="st">&#39;12-MA&#39;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span></code></pre></div>
<p><img src="../images/02/12-MA.png" /></p>
</div>
</div>
<div id="exponential-smoothing" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Exponential Smoothing<a href="smoothing.html#exponential-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hàm làm mịn Exponential là một hàm làm mịn sử dụng hàm mũ. Trong khi các hàm Moving Average đơn giản sử dụng các giá trị quá khứ với trọng số bằng nhau thì hàm Exponential sử dụng hàm số mũ cho trọng số đảm bảo giảm dần theo thời gian.</p>
<div id="simple-exponential-smoothing" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Simple Exponential Smoothing<a href="smoothing.html#simple-exponential-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hàm làm mịn Exponential thường áp dụng vào xử lý tín hiệu số để lọc những nhiễu có tầm số cao. Hàm này là dạy truy hồi với công thức như sau</p>
<p><span class="math inline">\(s_{0} = y_{0}\)</span></p>
<p><span class="math inline">\(s_{t} = \alpha y_{t} + (1 - \alpha)s_{t-1}, t &gt; 0\)</span></p>
<p>Trong đó <span class="math inline">\(\alpha\)</span> được gọi là tham số smoothing và <span class="math inline">\(0 &lt; \alpha &lt; 1\)</span></p>
<p><strong>Tại sao lại gọi là Hàm mũ</strong></p>
<p>Với công thức Truy hồi trên ta có thể biến đổi như sau</p>
<p><span class="math inline">\(s_t = \alpha y_t + (1 - \alpha)s_{t-1}\)</span></p>
<p><span class="math inline">\(s_t = \alpha y_t + (1 - \alpha)(\alpha y_{t-1} + (1 - \alpha)s_{t-2})\)</span></p>
<p><span class="math inline">\(s_t = \alpha y_t + \alpha(1 - \alpha)y_{t-1} + (1-\alpha)^2s_{t-2}\)</span></p>
<p><span class="math inline">\(s_t = \alpha[y_t + (1 - \alpha)y_{t-1} + (1-\alpha)^2y_{t-2} + (1-\alpha)^3y_{t-3} + ... +(1-\alpha)^Ty_0]\)</span></p>
<p>Ta có thể thấy <span class="math inline">\(s_t\)</span> có liên quan đến trung bình các giá trị với các trọng số
<span class="math inline">\(1, (1-\alpha), (1-\alpha)^2, ....,(1-\alpha)^T\)</span></p>
<p>Dưới đây là code mẫu cho cách tính Exponential Smoothing</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="smoothing.html#cb16-1" tabindex="-1"></a><span class="kw">def</span> exponential_smoothing(Y, alpha):</span>
<span id="cb16-2"><a href="smoothing.html#cb16-2" tabindex="-1"></a>    S <span class="op">=</span> np.zeros(Y.shape[<span class="dv">0</span>])</span>
<span id="cb16-3"><a href="smoothing.html#cb16-3" tabindex="-1"></a>    S[<span class="dv">0</span>] <span class="op">=</span> Y[<span class="dv">0</span>]</span>
<span id="cb16-4"><a href="smoothing.html#cb16-4" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, Y.shape[<span class="dv">0</span>]):</span>
<span id="cb16-5"><a href="smoothing.html#cb16-5" tabindex="-1"></a>        S[t] <span class="op">=</span> alpha <span class="op">*</span> Y[t] <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span> alpha) <span class="op">*</span> S[t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb16-6"><a href="smoothing.html#cb16-6" tabindex="-1"></a>    <span class="cf">return</span> S</span></code></pre></div>
<p>Hoặc chúng ta cũng có thể sử dụng phương thức <code>ewm</code> của <code>Pandas</code> hoặc Class <code>SimpleExpSmoothing</code> của thư viện <code>statsmodel.tsa</code></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="smoothing.html#cb17-1" tabindex="-1"></a><span class="im">from</span> statsmodels.api <span class="im">import</span> tsa</span>
<span id="cb17-2"><a href="smoothing.html#cb17-2" tabindex="-1"></a><span class="co">## dùng pandas</span></span>
<span id="cb17-3"><a href="smoothing.html#cb17-3" tabindex="-1"></a>df[<span class="st">&#39;ExponentialSmoothing_PANDAS&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Births&#39;</span>].ewm(alpha<span class="op">=</span><span class="fl">0.3</span>, adjust<span class="op">=</span><span class="va">False</span>).mean()</span>
<span id="cb17-4"><a href="smoothing.html#cb17-4" tabindex="-1"></a><span class="co">## dùng functions</span></span>
<span id="cb17-5"><a href="smoothing.html#cb17-5" tabindex="-1"></a>df[<span class="st">&#39;ExponentialSmoothing_FUNCTION&#39;</span>] <span class="op">=</span> exponential_smoothing(df[<span class="st">&#39;Births&#39;</span>], <span class="fl">0.3</span>)</span>
<span id="cb17-6"><a href="smoothing.html#cb17-6" tabindex="-1"></a><span class="co">## dùng tsa</span></span>
<span id="cb17-7"><a href="smoothing.html#cb17-7" tabindex="-1"></a>es <span class="op">=</span> tsa.SimpleExpSmoothing(df[<span class="st">&#39;Births&#39;</span>])</span>
<span id="cb17-8"><a href="smoothing.html#cb17-8" tabindex="-1"></a>df[<span class="st">&#39;ExponentialSmoothing_tSA&#39;</span>] <span class="op">=</span> es.predict(es.params, start<span class="op">=</span><span class="dv">1</span>, end<span class="op">=</span>df.shape[<span class="dv">0</span>])</span>
<span id="cb17-9"><a href="smoothing.html#cb17-9" tabindex="-1"></a>df</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="smoothing.html#cb18-1" tabindex="-1"></a>    Date        Births  ExponentialSmoothing_PANDAS ExponentialSmoothing_FUNCTION   ExponentialSmoothing_tSA</span>
<span id="cb18-2"><a href="smoothing.html#cb18-2" tabindex="-1"></a><span class="dv">0</span>   <span class="dv">1959</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>      <span class="dv">35</span>                    <span class="fl">35.000000</span>                     <span class="fl">35.000000</span>                  <span class="fl">35.000000</span></span>
<span id="cb18-3"><a href="smoothing.html#cb18-3" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">1959</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>      <span class="dv">32</span>                    <span class="fl">34.100000</span>                     <span class="fl">34.100000</span>                  <span class="fl">34.100000</span></span>
<span id="cb18-4"><a href="smoothing.html#cb18-4" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">1959</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>      <span class="dv">30</span>                    <span class="fl">32.870000</span>                     <span class="fl">32.870000</span>                  <span class="fl">32.870000</span></span>
<span id="cb18-5"><a href="smoothing.html#cb18-5" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">1959</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>      <span class="dv">31</span>                    <span class="fl">32.309000</span>                     <span class="fl">32.309000</span>                  <span class="fl">32.309000</span></span>
<span id="cb18-6"><a href="smoothing.html#cb18-6" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">1959</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>      <span class="dv">44</span>                    <span class="fl">35.816300</span>                     <span class="fl">35.816300</span>                  <span class="fl">35.816300</span></span>
<span id="cb18-7"><a href="smoothing.html#cb18-7" tabindex="-1"></a>...        ...     ...                          ...                           ...                        ...</span>
<span id="cb18-8"><a href="smoothing.html#cb18-8" tabindex="-1"></a><span class="dv">360</span> <span class="dv">1959</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">27</span>      <span class="dv">37</span>                    <span class="fl">38.828280</span>                     <span class="fl">38.828280</span>                  <span class="fl">38.828280</span></span>
<span id="cb18-9"><a href="smoothing.html#cb18-9" tabindex="-1"></a><span class="dv">361</span> <span class="dv">1959</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">28</span>      <span class="dv">52</span>                    <span class="fl">42.779796</span>                     <span class="fl">42.779796</span>                  <span class="fl">42.779796</span></span>
<span id="cb18-10"><a href="smoothing.html#cb18-10" tabindex="-1"></a><span class="dv">362</span> <span class="dv">1959</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">48</span>                    <span class="fl">44.345857</span>                     <span class="fl">44.345857</span>                  <span class="fl">44.345857</span></span>
<span id="cb18-11"><a href="smoothing.html#cb18-11" tabindex="-1"></a><span class="dv">363</span> <span class="dv">1959</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">30</span>      <span class="dv">55</span>                    <span class="fl">47.542100</span>                     <span class="fl">47.542100</span>                  <span class="fl">47.542100</span></span>
<span id="cb18-12"><a href="smoothing.html#cb18-12" tabindex="-1"></a><span class="dv">364</span> <span class="dv">1959</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">31</span>      <span class="dv">50</span>                    <span class="fl">48.279470</span>                     <span class="fl">48.279470</span>                  <span class="fl">48.279470</span></span></code></pre></div>
<p>Biểu đồ so sánh giữa giá trị gốc và Exponential Smoothing</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="smoothing.html#cb19-1" tabindex="-1"></a>fig4<span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb19-2"><a href="smoothing.html#cb19-2" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;Births&#39;</span>, data<span class="op">=</span>df, label<span class="op">=</span><span class="st">&#39;original&#39;</span>)</span>
<span id="cb19-3"><a href="smoothing.html#cb19-3" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;ExponentialSmoothing_PANDAS&#39;</span>, data<span class="op">=</span>df, label<span class="op">=</span><span class="st">&#39;ExponentialSmoothing&#39;</span>)</span>
<span id="cb19-4"><a href="smoothing.html#cb19-4" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date&#39;</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-5"><a href="smoothing.html#cb19-5" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-6"><a href="smoothing.html#cb19-6" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-7"><a href="smoothing.html#cb19-7" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Births&#39;</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-8"><a href="smoothing.html#cb19-8" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-9"><a href="smoothing.html#cb19-9" tabindex="-1"></a>plt.title(<span class="st">&#39;Exponential Smoothing with alpha=0.3&#39;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span></code></pre></div>
<p><img src="../images/02/Exponential_Smoothing.png" /></p>
</div>
<div id="double-exponential-smoothing-holts-method" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Double Exponential Smoothing (Holt’s Method)<a href="smoothing.html#double-exponential-smoothing-holts-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="triple-exponential-smoothing-holt-winters-method" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Triple Exponential Smoothing (Holt-Winters’ Method)<a href="smoothing.html#triple-exponential-smoothing-holt-winters-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="giới-thiệu-cơ-bản-về-time-series.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="arima.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "Merriweather",
"size": 4
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"toc_depth": 2,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
